p8105\_hw5\_pz2281
================
Peilin Zhou

``` r
library(tidyverse)
```

    ## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──

    ## ✓ ggplot2 3.3.5     ✓ purrr   0.3.4
    ## ✓ tibble  3.1.4     ✓ dplyr   1.0.7
    ## ✓ tidyr   1.1.3     ✓ stringr 1.4.0
    ## ✓ readr   2.0.1     ✓ forcats 0.5.1

    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## x dplyr::filter() masks stats::filter()
    ## x dplyr::lag()    masks stats::lag()

``` r
library(ggplot2)
```

## Problem 1

Import and clean the data

``` r
homicides_data = read_csv(file = "./data-homicides-master/homicide-data.csv", na = c("", "Unknown"))
```

    ## Rows: 52179 Columns: 12

    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (8): uid, victim_last, victim_first, victim_race, victim_sex, city, stat...
    ## dbl (4): reported_date, victim_age, lat, lon

    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
head(homicides_data) 
```

    ## # A tibble: 6 × 12
    ##   uid        reported_date victim_last victim_first victim_race victim_age victim_sex
    ##   <chr>              <dbl> <chr>       <chr>        <chr>            <dbl> <chr>     
    ## 1 Alb-000001      20100504 GARCIA      JUAN         Hispanic            78 Male      
    ## 2 Alb-000002      20100216 MONTOYA     CAMERON      Hispanic            17 Male      
    ## 3 Alb-000003      20100601 SATTERFIELD VIVIANA      White               15 Female    
    ## 4 Alb-000004      20100101 MENDIOLA    CARLOS       Hispanic            32 Male      
    ## 5 Alb-000005      20100102 MULA        VIVIAN       White               72 Female    
    ## 6 Alb-000006      20100126 BOOK        GERALDINE    White               91 Female    
    ## # … with 5 more variables: city <chr>, state <chr>, lat <dbl>, lon <dbl>,
    ## #   disposition <chr>

The raw data contained homicides cases from 50 large U.S. cities.
Variables include unique case id of each city from an ascending order,
reported date of the case, victim’s name, race, age, sex, where the case
happened specified in geographical coordinates and name of hte
city/state, and case disposition. There are 52179 observations and 12
variables. Missing values exist in victim\_race, victim\_age,
victim\_race, and geographical coordindates. Missing values were changed
to N/A. We see that there is one possible data entry error which city
Tulsa should be in state Oklahoma instead of Alabama. To make
consistency for later analysis, omit this one oberservation.

add new variables to the data frame and do summarization with conditions

``` r
homicides_data = homicides_data %>% 
  mutate(
    city_state = str_c(city,state, sep = ",")
  ) %>% 
  filter(city_state != "Tulsa,AL") %>% 
  relocate(city_state)

#total number of homicides within cities
homicides_data %>% 
  group_by(city_state) %>% 
  summarise(
    n = n()
  ) %>% knitr::kable()
```

| city\_state       |    n |
|:------------------|-----:|
| Albuquerque,NM    |  378 |
| Atlanta,GA        |  973 |
| Baltimore,MD      | 2827 |
| Baton Rouge,LA    |  424 |
| Birmingham,AL     |  800 |
| Boston,MA         |  614 |
| Buffalo,NY        |  521 |
| Charlotte,NC      |  687 |
| Chicago,IL        | 5535 |
| Cincinnati,OH     |  694 |
| Columbus,OH       | 1084 |
| Dallas,TX         | 1567 |
| Denver,CO         |  312 |
| Detroit,MI        | 2519 |
| Durham,NC         |  276 |
| Fort Worth,TX     |  549 |
| Fresno,CA         |  487 |
| Houston,TX        | 2942 |
| Indianapolis,IN   | 1322 |
| Jacksonville,FL   | 1168 |
| Kansas City,MO    | 1190 |
| Las Vegas,NV      | 1381 |
| Long Beach,CA     |  378 |
| Los Angeles,CA    | 2257 |
| Louisville,KY     |  576 |
| Memphis,TN        | 1514 |
| Miami,FL          |  744 |
| Milwaukee,wI      | 1115 |
| Minneapolis,MN    |  366 |
| Nashville,TN      |  767 |
| New Orleans,LA    | 1434 |
| New York,NY       |  627 |
| Oakland,CA        |  947 |
| Oklahoma City,OK  |  672 |
| Omaha,NE          |  409 |
| Philadelphia,PA   | 3037 |
| Phoenix,AZ        |  914 |
| Pittsburgh,PA     |  631 |
| Richmond,VA       |  429 |
| Sacramento,CA     |  376 |
| San Antonio,TX    |  833 |
| San Bernardino,CA |  275 |
| San Diego,CA      |  461 |
| San Francisco,CA  |  663 |
| Savannah,GA       |  246 |
| St. Louis,MO      | 1677 |
| Stockton,CA       |  444 |
| Tampa,FL          |  208 |
| Tulsa,OK          |  583 |
| Washington,DC     | 1345 |

Total number of homicide cases within each city as a table.

``` r
#total number of unsolved homicides
homicides_data  = homicides_data %>% 
  mutate(status = ifelse(disposition == "Closed by arrest", "solved", "unsolved")) 

unsolved_table = homicides_data %>% 
  filter(status == "unsolved") %>% 
  group_by(city_state) %>% 
  summarise(unsolved_case = n()) %>% 
  knitr::kable()
unsolved_table
```

| city\_state       | unsolved\_case |
|:------------------|---------------:|
| Albuquerque,NM    |            146 |
| Atlanta,GA        |            373 |
| Baltimore,MD      |           1825 |
| Baton Rouge,LA    |            196 |
| Birmingham,AL     |            347 |
| Boston,MA         |            310 |
| Buffalo,NY        |            319 |
| Charlotte,NC      |            206 |
| Chicago,IL        |           4073 |
| Cincinnati,OH     |            309 |
| Columbus,OH       |            575 |
| Dallas,TX         |            754 |
| Denver,CO         |            169 |
| Detroit,MI        |           1482 |
| Durham,NC         |            101 |
| Fort Worth,TX     |            255 |
| Fresno,CA         |            169 |
| Houston,TX        |           1493 |
| Indianapolis,IN   |            594 |
| Jacksonville,FL   |            597 |
| Kansas City,MO    |            486 |
| Las Vegas,NV      |            572 |
| Long Beach,CA     |            156 |
| Los Angeles,CA    |           1106 |
| Louisville,KY     |            261 |
| Memphis,TN        |            483 |
| Miami,FL          |            450 |
| Milwaukee,wI      |            403 |
| Minneapolis,MN    |            187 |
| Nashville,TN      |            278 |
| New Orleans,LA    |            930 |
| New York,NY       |            243 |
| Oakland,CA        |            508 |
| Oklahoma City,OK  |            326 |
| Omaha,NE          |            169 |
| Philadelphia,PA   |           1360 |
| Phoenix,AZ        |            504 |
| Pittsburgh,PA     |            337 |
| Richmond,VA       |            113 |
| Sacramento,CA     |            139 |
| San Antonio,TX    |            357 |
| San Bernardino,CA |            170 |
| San Diego,CA      |            175 |
| San Francisco,CA  |            336 |
| Savannah,GA       |            115 |
| St. Louis,MO      |            905 |
| Stockton,CA       |            266 |
| Tampa,FL          |             95 |
| Tulsa,OK          |            193 |
| Washington,DC     |            589 |

Total number of unsolved homicide cases within each city as a table.

Conduct prop.test for Baltimore,MD

``` r
bal_unsolved_data = homicides_data %>% 
  filter(city_state == "Baltimore,MD") %>% 
  summarise(
    unsolved = sum(status == "unsolved"),
    num_case = n()
  ) 

bal_test_result = 
  prop.test(x = bal_unsolved_data %>% pull(unsolved), n = bal_unsolved_data %>% pull(num_case)) %>% 
  broom::tidy() %>% 
  select(estimate, conf.low, conf.high)
bal_test_result
```

    ## # A tibble: 1 × 3
    ##   estimate conf.low conf.high
    ##      <dbl>    <dbl>     <dbl>
    ## 1    0.646    0.628     0.663

The estimated proportion of unsolved homicides in Baltimore is
0.6455607. The 95% confidence interval is 0.6275625 to 0.6631599.
